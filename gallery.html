<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gallery — EasyFix Solutions</title>
  <link rel="stylesheet" href="styles.css">
  <!-- optional: gallery specific styles -->
  <style>
    .gallery-container{max-width:1100px;margin:40px auto;padding:0 20px}
    .gallery-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .g-item{position:relative;overflow:hidden;border-radius:8px;background:#111}
    .g-item img, .g-item video{width:100%;height:160px;object-fit:cover;display:block}
    .g-caption{position:absolute;left:8px;bottom:8px;color:#fff;background:rgba(0,0,0,0.5);padding:6px 8px;border-radius:6px;font-size:14px}
    /* lightbox */
    .lightbox{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.85);z-index:9999;padding:20px}
    .lightbox.active{display:flex}
    .lightbox-content{max-width:1100px;max-height:85vh}
    .lightbox-content img, .lightbox-content video{width:100%;height:auto;max-height:85vh;border-radius:8px}
    .lightbox-close{position:fixed;top:18px;right:18px;color:#fff;font-size:28px;cursor:pointer}
  </style>
</head>
<body>
  <!-- simple header (or reuse your header) -->
  <header style="background:#0B2F6A;color:#fff;padding:14px 20px;">
    <div style="max-width:1100px;margin:0 auto;display:flex;justify-content:space-between;align-items:center">
      <div><img src="logo.png" alt="logo" style="height:40px;vertical-align:middle"><strong style="margin-left:8px">EasyFix Solutions</strong></div>
      <nav><a href="index.html" style="color:#fff;margin-left:12px">Home</a></nav>
    </div>
  </header>

  <main class="gallery-container">
    <h1 style="color:#0B2F6A">Gallery</h1>
    <p style="color:#555">Images & Videos — upload files to your repo and add entries in <code>gallery.json</code>.</p>

    <div id="galleryGrid" class="gallery-grid"></div>
  </main>

  <!-- lightbox -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lightbox-close" id="lbClose">&times;</div>
    <div class="lightbox-content" id="lbContent"></div>
  </div>

  <script>
    // Fetch gallery.json and render
    fetch('gallery.json')
      .then(r => {
        if(!r.ok) throw new Error('gallery.json not found');
        return r.json();
      })
      .then(data => renderGallery(data))
      .catch(err => {
        document.getElementById('galleryGrid').innerHTML = '<p style="color:#c00">Unable to load gallery.json — please upload it to the repo.</p>';
        console.error(err);
      });

    function renderGallery(items){
      const grid = document.getElementById('galleryGrid');
      grid.innerHTML = '';
      items.forEach((it,idx) => {
        const div = document.createElement('div');
        div.className = 'g-item';
        div.dataset.index = idx;

        if(it.type === 'image'){
          const img = document.createElement('img');
          img.src = it.src;
          img.alt = it.title || '';
          div.appendChild(img);
        } else if(it.type === 'video'){
          const vid = document.createElement('video');
          vid.src = it.src;
          vid.muted = true;
          vid.playsInline = true;
          vid.setAttribute('preload','metadata');
          div.appendChild(vid);
        }

        const cap = document.createElement('div');
        cap.className = 'g-caption';
        cap.textContent = it.title || (it.type==='video'?'Video':'Image');
        div.appendChild(cap);

        // click open lightbox
        div.addEventListener('click', ()=> openLightbox(it));
        grid.appendChild(div);
      });
    }

    function openLightbox(item){
      const lb = document.getElementById('lightbox');
      const cont = document.getElementById('lbContent');
      cont.innerHTML = '';
      if(item.type === 'image'){
        const img = document.createElement('img');
        img.src = item.src;
        img.alt = item.title || '';
        cont.appendChild(img);
      } else if(item.type === 'video'){
        const v = document.createElement('video');
        v.src = item.src;
        v.controls = true;
        v.autoplay = true;
        cont.appendChild(v);
      }
      lb.classList.add('active');
      lb.setAttribute('aria-hidden','false');
    }

    document.getElementById('lbClose').addEventListener('click', ()=>{
      const lb = document.getElementById('lightbox');
      lb.classList.remove('active');
      lb.setAttribute('aria-hidden','true');
      const cont = document.getElementById('lbContent');
      cont.innerHTML = '';
    });

    // close on outside click or ESC
    document.getElementById('lightbox').addEventListener('click', function(e){
      if(e.target === this) { this.classList.remove('active'); document.getElementById('lbContent').innerHTML=''; }
    });
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') { document.getElementById('lightbox').classList.remove('active'); document.getElementById('lbContent').innerHTML=''; }});
  </script>
</body>
</html>
